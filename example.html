<html>
<head>
	<script type="text/javascript" src="ajaxindicator.js"></script>
	<script>
		window.XMLHttpRequest.onOpenGlobal = function(openCalls) {
			document.getElementById('ajaxIndicator').style.display = 'block';
		};
		window.XMLHttpRequest.onDoneGlobal = function(openCalls) {
			if (openCalls == 0) {
				document.getElementById('ajaxIndicator').style.display = 'none';
			}
		};
		
		// showing every ajax activity, the indicator displays at least 500 ms
		window.XMLHttpRequest.doneCallbackDelay = 500;
		window.XMLHttpRequest.openCallbackDelay = 0;
		
		// OR: hiding ajax spikes shorter than 100 ms, when visible, the indicator displays for 500 ms
		//window.XMLHttpRequest.doneCallbackDelay = 500;
		//window.XMLHttpRequest.openCallbackDelay = 100;
	</script>
	<style>
		#ajaxIndicator {
			width: 100px;
			height: 100px;
			background: red;
		}
	</style>
</head>
<body>
	<div id="ajaxIndicator" style="display:none;">AJAX call in progress</div>
	<div class="content">
		<span>Click this button for some AJAX magic...</span>
		<input type="button" onclick="alert('your AJAX call here...');">AJAX!</input>
	</div>
</body>
</html>