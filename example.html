<!doctype html>
<html>
<head>
	<script type="text/javascript" src="ajaxindicator.js"></script>
	<script>
		function handleAjaxIndicator(openCalls) {
			if (openCalls == 0) {
				// HIDE INDICATOR
				document.getElementById('ajaxIndicator').style.background = 'white';
			} else {
				// SHOW INDICATOR
				document.getElementById('ajaxIndicator').style.background = 'darkRed';
			} 
		}
		
		window.XMLHttpRequest.onOpenGlobal = handleAjaxIndicator;
		window.XMLHttpRequest.onDoneGlobal = handleAjaxIndicator;
		
		// showing every ajax activity, the indicator displays at least 500 ms
		window.XMLHttpRequest.doneCallbackDelay = 500;
		window.XMLHttpRequest.openCallbackDelay = 0;
		
		// OR: hiding comminication spikes shorter than 100 ms, when visible, the indicator displays for 500 ms
		//window.XMLHttpRequest.doneCallbackDelay = 500;
		//window.XMLHttpRequest.openCallbackDelay = 100;
	</script>
	<style>
		#ajaxIndicator {
			width: 100px;
			height: 100px;
			color: white;
			font-weight: bold;
			padding: 10px;
		}
	</style>
</head>
<body>
	<div id="ajaxIndicator" style="background:white;">AJAX call in progress!</div>
	<div class="content">
		<span>Click this button for some AJAX magic...</span>
		<input type="button" onclick="YOUR_AJAX_CALL_HERE(...);">AJAX!</input>
	</div>
</body>
</html>